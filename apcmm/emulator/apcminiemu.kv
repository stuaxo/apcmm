#:import mido mido

#:import ListItemButton kivy.uix.listview.ListItemButton

#:import la kivy.adapters.listadapter
#:import APCMiniWidget apcmm.emulator.widgets.APCMiniWidget

<ClipButton>:
    Image:
        source: 'images/clip-button-grey.png'

<SceneButton>:
    Image:
        source: 'images/round-button-grey.png'
        size_hint: 1, 1

<ControlButton>:
    Image:
        source: 'images/round-button-grey.png'
        size_hint: 1, 1


<MidiChooserPopup>:
    id: midipopup
    size_hint: .5, .5
    auto_dismiss: True
    title: 'Connect To Midi'
    BoxLayout:
        id: content
        orientation: "vertical"

        ListView:
            id: midi_devices
            size_hint: 1,.8

            adapter:
                la.ListAdapter(
                data=["Disconnected"] + mido.get_ioport_names(),
                cls=ListItemButton,
                allow_empty_selection=True,
                selection_mode='single',
                )

        Button:
            text: 'Cancel'
            on_press: root.dismiss()
            size_hint_y: 0.2

<ApcMiniScreen>:
    id: apc_screen
    FloatLayout:
        ActionBar:
            size_hint: 1,0.1
            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    title: 'Blinkenlights'
                ActionOverflow:
                ActionButton:
                    text: '> %s' % app.midi_port # TODO - load this from config
                    size_hint: 1, 1
                    on_release: apc_screen.toggle_midi_dropdown(self)
                    id: toggle_midi_popup
                ActionButton:
                    text: 'Gate'
                ActionButton:
                    text: 'Toggle'
                ActionButton:
                    text: 'Clear'
                    id: 'clear_all'
                    on_press: apc_widget.clear_all_lights()
                ActionGroup:
                    text: 'Group1'
                    #mode: 'spinner'
                    ActionButton:
                        text: 'Off'
                    ActionButton:
                        text: 'Green'
                        background: [0, .5, 0]
                    ActionButton:
                        text: 'Red'
                        color: [.5, 0, 0]
                    ActionButton:
                        text: 'Yellow'
                        color: [.5, .5, 0]
        APCMiniWidget:
            model: app.virtual_apc
            id: apc_widget
            size_hint: 1, 0.9
